{
  "services": [
    {
      "id": "stable-diffusion-webui",
      "name": "stable-diffusion-webui",
      "image": "universonic/stable-diffusion-webui:minimal",
      "container_name": "stable-diffusion-webui",
      "command": "--no-half --no-half-vae --precision full",
      "internalPort": 8080,
      "environment": {
        "PUID": "1000",
        "PGID": "1000",
        "NVIDIA_VISIBLE_DEVICES": "all",
        "NVIDIA_DRIVER_CAPABILITIES": "all"
        },
      "volumes": [
        {
          "hostPath": "${APP_DATA_DIR}/inputs",
          "containerPath": "/app/stable-diffusion-webui/inputs",
          "readOnly": false
        },
        {
          "hostPath": "${APP_DATA_DIR}/textual_inversion_templates",
          "containerPath": "/app/stable-diffusion-webui/textual_inversion_templates",
          "readOnly": false
        },
        {
          "hostPath": "${APP_DATA_DIR}/embeddings",
          "containerPath": "/app/stable-diffusion-webui/embeddings",
          "readOnly": false
        },
        {
          "hostPath": "${APP_DATA_DIR}/extensions",
          "containerPath": "/app/stable-diffusion-webui/extensions",
          "readOnly": false
        },
        {
          "hostPath": "${APP_DATA_DIR}/models",
          "containerPath": "/app/stable-diffusion-webui/models",
          "readOnly": false
        },
        {
          "hostPath": "${APP_DATA_DIR}/localizations",
          "containerPath": "/app/stable-diffusion-webui/localizations",
          "readOnly": false
        },
        {
          "hostPath": "${APP_DATA_DIR}/outputs",
          "containerPath": "/app/stable-diffusion-webui/outputs",
          "readOnly": false
        }
      ],
     "labels": {
        "traefik.enable": "true",
        "traefik.http.routers.stable-diffusion-webui.rule": "Host(`stable-diffusion-webui.wittgenstein9kv2.local`)",
        "traefik.http.routers.stable-diffusion-webui.entrypoints": "websecure",
        "traefik.http.routers.stable-diffusion-webui.tls.certresolver": "myresolver",
        "traefik.http.services.stable-diffusion-webui.loadbalancer.server.port": "9999",
        "traefik.http.routers.stable-diffusion-webui.priority": "100"
      },
      "capAdd": [
        "NET_BIND_SERVICE"
      ],
      "capDrop": [
        "ALL"
      ],
      "deploy": {
        "mode": "global",
        "placement": {
          "constraints": [
            "node.labels.iface != extern"
          ]
        },
        "restart_policy": {
          "condition": "unless-stopped"
        },
        "resources": {
          "reservations": {
            "devices": [
              {
                "driver": "nvidia",
                "capabilities": [
                  "gpu"
                ]
              }
            ]
          }
        }
      }
    }
  ]
}
